"use strict";(self["webpackChunkweek6_2"]=self["webpackChunkweek6_2"]||[]).push([[820],{6820:function(e,a,t){t.r(a),t.d(a,{default:function(){return N}});var l=t(3396),s=t(7139),i=t(9242);const o={class:"container"},r={class:"row flex-column align-items-center"},n={class:"col-8"},d=(0,l._)("h2",{class:"py-5 text-center fw-bold"},"Cart",-1),c={class:"table"},m=(0,l._)("td",{colspan:"2"},null,-1),u={colspan:"4",class:"text-end"},h=(0,l._)("tr",null,[(0,l._)("th",{scope:"col"},"刪除"),(0,l._)("th",{scope:"col"},"商品圖"),(0,l._)("th",{scope:"col"},"品名"),(0,l._)("th",{scope:"col"},"數量/單位"),(0,l._)("th",{scope:"col"},"單價"),(0,l._)("th",{scope:"col"},"小計")],-1),p={scope:"row"},b=["onClick"],_=(0,l._)("i",{class:"bi bi-x-lg",style:{"line-height":"100%"}},null,-1),g=[_],f=["src"],v={width:"28%"},y={class:"d-flex align-items-center"},C={class:"input-group input-group-sm",style:{width:"auto","margin-right":"0.5rem"}},x=["onClick"],k=(0,l._)("i",{class:"bi bi-dash"},null,-1),w=[k],L=["value"],V=["onClick"],$=(0,l._)("i",{class:"bi bi-plus"},null,-1),W=[$],F={colspan:"6",class:"text-end"},U={class:"col-6"},q={class:"border border-2 border-light p-5"},z=(0,l._)("p",{class:"text-center fw-bold h5 mb-3"},"收件人",-1),B={class:"mb-3"},D=(0,l._)("label",{for:"email",class:"form-label"},[(0,l.Uk)(" Email"),(0,l._)("span",{class:"text-danger"},"*")],-1),Q={class:"mb-3"},E=(0,l._)("label",{for:"name",class:"form-label"},[(0,l.Uk)("收件人姓名"),(0,l._)("span",{class:"text-danger"},"*")],-1),I={class:"mb-3"},S=(0,l._)("label",{for:"tel",class:"form-label"},[(0,l.Uk)("收件人電話"),(0,l._)("span",{class:"text-danger"},"*")],-1),H={class:"mb-3"},K=(0,l._)("label",{for:"address",class:"form-label"},[(0,l.Uk)(" 收件人地址"),(0,l._)("span",{class:"text-danger"},"*")],-1),M={class:"mb-3"},O=(0,l._)("label",{for:"message",class:"form-label"},"留言",-1),Y={class:"text-end"},Z={type:"submit",class:"btn btn-primary",ref:"submitBtn"};function j(e,a,t,_,k,$){const j=(0,l.up)("v-field"),A=(0,l.up)("error-message"),G=(0,l.up)("v-form"),J=(0,l.up)("v-loading");return(0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",r,[(0,l._)("div",n,[d,(0,l._)("table",c,[(0,l._)("thead",null,[(0,l._)("tr",null,[m,(0,l._)("td",u,[(0,l._)("button",{type:"button",class:(0,s.C_)(["btn btn-outline-danger btn-sm",{disabled:k.isLoading}]),onClick:a[0]||(a[0]=(...e)=>$.clearCarts&&$.clearCarts(...e))}," 清除購物車 ",2)])]),h]),(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(k.cartsList.carts,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e},[(0,l._)("th",p,[(0,l._)("a",{href:"#","aria-label":"delete",class:(0,s.C_)(["btn btn-sm btn-outline-secondary",{disabled:k.isLoading}]),onClick:(0,i.iM)((a=>$.delCartItem(e.id)),["prevent"])},g,10,b)]),(0,l._)("td",null,[(0,l._)("img",{src:e.product.imageUrl,width:"50",alt:"",srcset:""},null,8,f)]),(0,l._)("td",null,(0,s.zw)(e.product.title),1),(0,l._)("td",v,[(0,l._)("div",y,[(0,l._)("div",C,[(0,l._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:a=>$.changeQty(e.id,e.product_id,e.qty-1)},w,8,x),(0,l._)("input",{type:"text",class:"form-control flex-grow-0 text-center",placeholder:"test",value:e.qty,style:{width:"40px"},"aria-labelledby":"bty"},null,8,L),(0,l._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:a=>$.changeQty(e.id,e.product_id,e.qty+1)},W,8,V)]),(0,l.Uk)(" "+(0,s.zw)(e.product.unit),1)])]),(0,l._)("td",null,"$ "+(0,s.zw)(e.product.price),1),(0,l._)("td",null,"$ "+(0,s.zw)(e.total),1)])))),128)),(0,l._)("tr",null,[(0,l._)("td",F,"總計 $ "+(0,s.zw)(k.cartsList.total),1)])])])]),(0,l._)("div",U,[(0,l._)("div",q,[z,(0,l.Wm)(G,{onSubmit:e.createOrder,ref:"form"},{default:(0,l.w5)((({errors:e})=>[(0,l._)("div",B,[D,(0,l.Wm)(j,{type:"email",id:"email1",name:"email",class:(0,s.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:k.dataForm.user.email,"onUpdate:modelValue":a[1]||(a[1]=e=>k.dataForm.user.email=e),"aria-label":"email"},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"email",class:"invalid-feedback"})]),(0,l._)("div",Q,[E,(0,l.Wm)(j,{type:"text",id:"name",name:"姓名",class:(0,s.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入 姓名",rules:"required",modelValue:k.dataForm.user.name,"onUpdate:modelValue":a[2]||(a[2]=e=>k.dataForm.user.name=e)},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",I,[S,(0,l.Wm)(j,{type:"tel",id:"tel",name:"電話",class:(0,s.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入 電話",rules:"required|min:8",modelValue:k.dataForm.user.tel,"onUpdate:modelValue":a[3]||(a[3]=e=>k.dataForm.user.tel=e)},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",H,[K,(0,l.Wm)(j,{type:"text",id:"address",name:"地址",class:(0,s.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入 地址",rules:"required",modelValue:k.dataForm.user.address,"onUpdate:modelValue":a[4]||(a[4]=e=>k.dataForm.user.address=e)},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",M,[O,(0,l.Wm)(j,{type:"text",id:"message",name:"留言",class:(0,s.C_)(["form-control",{"is-invalid":e["留言"]}]),placeholder:"留言訊息",rules:"max:10",modelValue:k.dataForm.message,"onUpdate:modelValue":a[5]||(a[5]=e=>k.dataForm.message=e),as:"textarea"},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"留言",class:"invalid-feedback"})]),(0,l._)("div",Y,[(0,l._)("button",Z,"送出訂單",512)])])),_:1},8,["onSubmit"])])])]),(0,l.Wm)(J,{active:k.isLoading,loader:"dots"},null,8,["active"])])}var A={data(){return{isLoading:!1,cartsList:[],dataForm:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){const e="https://vue3-course-api.hexschool.io/v2/api/groen/cart";this.isLoading=!0,this.$http.get(e).then((e=>{this.cartsList=e.data.data,this.isLoading=!1,console.log(this.cartsList),this.cartsList.carts.length<=0||0===this.cartsList.final_total?this.$refs.submitBtn.disabled=!0:this.$refs.submitBtn.disabled=!1})).catch((a=>{this.isLoading=!1,alert(`updateCart ${e} ${a}`)}))},changeQty(e,a,t){const l=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${e}`,s={product_id:a,qty:t};this.isLoading=!0,console.log(e,s),this.$http.put(l,{data:s}).then((e=>{this.getCarts(),alert(e.data.message)})).catch((e=>{console.log(e),this.isLoading=!1}))},delCartItem(e){const a=`https://vue3-course-api.hexschool.io/v2/api/groen/cart/${e}`;this.isLoading=!0,this.$http.delete(a).then((e=>{this.getCarts(),alert(e.data.message)})).catch((e=>{alert(e.data.message),this.isLoading=!1}))},clearCarts(){const e="https://vue3-course-api.hexschool.io/v2/api/groen/carts";this.isLoading=!0,this.$http.delete(e).then((e=>{this.getCarts(),alert(e.data.message)})).catch((e=>{alert(e.data.message),this.isLoading=!1}))}},mounted(){this.getCarts()}},G=t(89);const J=(0,G.Z)(A,[["render",j]]);var N=J}}]);
//# sourceMappingURL=820.7450b344.js.map