"use strict";(self["webpackChunkweek6_2"]=self["webpackChunkweek6_2"]||[]).push([[604],{7604:function(e,a,t){t.r(a),t.d(a,{default:function(){return R}});var s=t(3396),l=t(7139),i=t(9242);const r={class:"container"},d={class:"row flex-column align-items-center"},n={class:"col-8"},o=(0,s._)("h2",{class:"py-5 text-center fw-bold"},"Cart",-1),c={class:"table align-middle"},m=(0,s._)("td",{colspan:"2"},null,-1),u={colspan:"4",class:"text-end"},h=(0,s._)("tr",null,[(0,s._)("th",{scope:"col"},"刪除"),(0,s._)("th",{scope:"col"},"商品圖"),(0,s._)("th",{scope:"col"},"品名"),(0,s._)("th",{scope:"col"},"數量/單位"),(0,s._)("th",{scope:"col"},"單價"),(0,s._)("th",{scope:"col"},"小計")],-1),p={scope:"row"},b=["onClick"],_=(0,s._)("i",{class:"bi bi-x-lg",style:{"line-height":"100%"}},null,-1),g=[_],f=["src"],v={width:"28%"},C={class:"d-flex align-items-center"},y={class:"input-group input-group-sm",style:{width:"auto","margin-right":"0.5rem"}},$=["onClick"],k=(0,s._)("i",{class:"bi bi-dash"},null,-1),w=[k],x=["value"],L=["onClick"],V=(0,s._)("i",{class:"bi bi-plus"},null,-1),F=[V],W={colspan:"6",class:"text-end"},U={class:"col-6"},q={class:"border border-2 border-light p-5"},B=(0,s._)("p",{class:"text-center fw-bold h5 mb-3"},"收件人",-1),z={class:"mb-3"},D=(0,s._)("label",{for:"email",class:"form-label"},[(0,s.Uk)(" Email"),(0,s._)("span",{class:"text-danger"},"*")],-1),Q={class:"mb-3"},E=(0,s._)("label",{for:"name",class:"form-label"},[(0,s.Uk)("收件人姓名"),(0,s._)("span",{class:"text-danger"},"*")],-1),I={class:"mb-3"},O=(0,s._)("label",{for:"tel",class:"form-label"},[(0,s.Uk)("收件人電話"),(0,s._)("span",{class:"text-danger"},"*")],-1),S={class:"mb-3"},H=(0,s._)("label",{for:"address",class:"form-label"},[(0,s.Uk)(" 收件人地址"),(0,s._)("span",{class:"text-danger"},"*")],-1),K={class:"mb-3"},M=(0,s._)("label",{for:"message",class:"form-label"},"留言",-1),Y={class:"text-end"},Z={type:"submit",class:"btn btn-primary",ref:"submitBtn"};function j(e,a,t,_,k,V){const j=(0,s.up)("v-loading"),A=(0,s.up)("v-field"),G=(0,s.up)("error-message"),J=(0,s.up)("v-form");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s.Wm)(j,{active:k.isLoading,loader:"dots"},null,8,["active"]),(0,s._)("div",d,[(0,s._)("div",n,[o,(0,s._)("table",c,[(0,s._)("thead",null,[(0,s._)("tr",null,[m,(0,s._)("td",u,[(0,s._)("button",{type:"button",class:(0,l.C_)(["btn btn-outline-danger btn-sm",{disabled:k.isLoading}]),onClick:a[0]||(a[0]=(...e)=>V.clearCarts&&V.clearCarts(...e)),ref:"clearCartBtn"}," 清除購物車 ",2)])]),h]),(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.cartsList.carts,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e},[(0,s._)("th",p,[(0,s._)("a",{href:"#","aria-label":"delete",class:(0,l.C_)(["btn btn-sm btn-outline-secondary",{disabled:k.isLoading}]),onClick:(0,i.iM)((a=>V.delCartItem(e.id)),["prevent"])},g,10,b)]),(0,s._)("td",null,[(0,s._)("img",{src:e.product.imageUrl,width:"50",alt:"",srcset:""},null,8,f)]),(0,s._)("td",null,(0,l.zw)(e.product.title),1),(0,s._)("td",v,[(0,s._)("div",C,[(0,s._)("div",y,[(0,s._)("button",{class:(0,l.C_)(["btn btn-outline-secondary",{disabled:1===e.qty}]),type:"button",onClick:a=>V.changeQty(e.id,e.product_id,e.qty-1)},w,10,$),(0,s._)("input",{type:"text",class:"form-control flex-grow-0 text-center",placeholder:"test",value:e.qty,style:{width:"40px"},"aria-labelledby":"bty",readonly:""},null,8,x),(0,s._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:a=>V.changeQty(e.id,e.product_id,e.qty+1)},F,8,L)]),(0,s.Uk)(" "+(0,l.zw)(e.product.unit),1)])]),(0,s._)("td",null,"$ "+(0,l.zw)(e.product.price),1),(0,s._)("td",null,"$ "+(0,l.zw)(e.total),1)])))),128)),(0,s._)("tr",null,[(0,s._)("td",W,"總計 $ "+(0,l.zw)(k.cartsList.total),1)])])])]),(0,s._)("div",U,[(0,s._)("div",q,[B,(0,s.Wm)(J,{onSubmit:V.createOrder,ref:"form"},{default:(0,s.w5)((({errors:e})=>[(0,s._)("div",z,[D,(0,s.Wm)(A,{type:"email",id:"email1",name:"email",class:(0,l.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:k.dataForm.user.email,"onUpdate:modelValue":a[1]||(a[1]=e=>k.dataForm.user.email=e),"aria-label":"email"},null,8,["class","modelValue"]),(0,s.Wm)(G,{name:"email",class:"invalid-feedback"})]),(0,s._)("div",Q,[E,(0,s.Wm)(A,{type:"text",id:"name",name:"姓名",class:(0,l.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入 姓名",rules:"required",modelValue:k.dataForm.user.name,"onUpdate:modelValue":a[2]||(a[2]=e=>k.dataForm.user.name=e)},null,8,["class","modelValue"]),(0,s.Wm)(G,{name:"姓名",class:"invalid-feedback"})]),(0,s._)("div",I,[O,(0,s.Wm)(A,{type:"tel",id:"tel",name:"電話",class:(0,l.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入 電話",rules:"required|min:8",modelValue:k.dataForm.user.tel,"onUpdate:modelValue":a[3]||(a[3]=e=>k.dataForm.user.tel=e)},null,8,["class","modelValue"]),(0,s.Wm)(G,{name:"電話",class:"invalid-feedback"})]),(0,s._)("div",S,[H,(0,s.Wm)(A,{type:"text",id:"address",name:"地址",class:(0,l.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入 地址",rules:"required",modelValue:k.dataForm.user.address,"onUpdate:modelValue":a[4]||(a[4]=e=>k.dataForm.user.address=e)},null,8,["class","modelValue"]),(0,s.Wm)(G,{name:"地址",class:"invalid-feedback"})]),(0,s._)("div",K,[M,(0,s.Wm)(A,{type:"text",id:"message",name:"留言",class:(0,l.C_)(["form-control",{"is-invalid":e["留言"]}]),placeholder:"留言訊息",rules:"max:10",modelValue:k.dataForm.message,"onUpdate:modelValue":a[5]||(a[5]=e=>k.dataForm.message=e),as:"textarea"},null,8,["class","modelValue"]),(0,s.Wm)(G,{name:"留言",class:"invalid-feedback"})]),(0,s._)("div",Y,[(0,s._)("button",Z,"送出訂單",512)])])),_:1},8,["onSubmit"])])])])])}const A="https://vue3-course-api.hexschool.io/v2",G="groen";var J={data(){return{isLoading:!1,cartsList:[],dataForm:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCarts(){const e=`${A}/api/${G}/cart`;this.isLoading=!0,this.$http.get(e).then((e=>{this.cartsList=e.data.data,this.isLoading=!1,this.cartsList.carts.length<=0||0===this.cartsList.final_total?(this.$refs.submitBtn.disabled=!0,this.$refs.clearCartBtn.disabled=!0):(this.$refs.submitBtn.disabled=!1,this.$refs.clearCartBtn.disabled=!1)})).catch((a=>{this.isLoading=!1,alert(`getCarts ${e} ${a}`)}))},changeQty(e,a,t){const s=`${A}/api/${G}/cart/${e}`,l={product_id:a,qty:t};this.isLoading=!0,this.$http.put(s,{data:l}).then((e=>{this.getCarts(),alert(e.data.message)})).catch((e=>{alert(e.data.message),this.isLoading=!1}))},delCartItem(e){const a=`${A}/api/${G}/cart/${e}`;this.isLoading=!0,this.$http.delete(a).then((e=>{this.getCarts(),alert(e.data.message)})).catch((e=>{alert(e.data.message),this.isLoading=!1}))},clearCarts(){const e=`${A}/api/${G}/carts`;this.isLoading=!0,this.$http.delete(e).then((e=>{this.getCarts(),alert(e.data.message)})).catch((e=>{alert(e.data.message),this.isLoading=!1}))},createOrder(){const e=`${A}/api/${G}/order`;this.$http.post(e,{data:this.dataForm}).then((e=>{alert(e.data.message),this.getCarts(),this.$refs.form.resetForm()})).catch((e=>{alert(e.data.message)}))}},mounted(){this.getCarts()}},N=t(89);const P=(0,N.Z)(J,[["render",j]]);var R=P}}]);
//# sourceMappingURL=604.78e4c676.js.map